jmp main 
;Henrique F. M. Freitas - 8937225


;tela de introdução inicial.
	intro1: string "                                        "
	intro2: string "             The Battle                 "
	intro3: string "                 Of                     "
	intro4: string "   _    _    ____   ._______   _    _   "
	intro5: string "  | |  | |  / __ \\ |        | | |  | |  "
	intro6: string "  | |__| | | |  | | `--| |--  | |__| |  "
	intro7: string "  |  __  | | |  | |    | |    |  __  |  "
	intro8: string "  | |  | | | `--' |    | |    | |  | |  "
	intro9: string "  |_|  |_|  \\____/     |_|    |_|  |_|  "
	intro10: string "                                        "
	intro11: string "                                        "
	intro12: string "                                        "
	intro13: string "    It is a dark time for the           "
	intro14: string "    Rebellion. Although the Death       "
	intro15: string "    Star has been destroyed,            "
	intro16: string "    Imperial troops have driven the     "
	intro17: string "    Rebel forces from their hidden      "
	intro18: string "    base and pursued them across        "
	intro19: string "    the galaxy                          "
	intro20: string "                                        "
	intro21: string "    Evading the dreaded Imperial        "
	intro22: string "    Starfleet, a group of freedom       "
	intro23: string "    fighters led by Luke Skywalker      "
	intro24: string "    has established a new secret base   "
	intro25: string "    on the remote ice world of Hoth     "
	intro26: string "                                        "
	intro27: string "                                        "
	intro28: string "             [PRESS ENTER]              "
	intro29: string "                                        "
	intro30: string "                                        "


;tela de briefing.
	intros1: string "                                        "
	intros2: string "       You are  a stormtrooper.         "
	intros3: string "       prove your honor to the          "
	intros4: string "       empire, show the rebel           "
	intros5: string "       scum who is right.               "
	intros6: string "                                        "
	intros7: string "                                        "
	intros8: string "                                        "
	intros9: string "                                        "
	intros10: string "                                        "
	intros11: string "                                        "
	intros12: string "                                        "
	intros13: string "       Shoot to kill.                   "
	intros14: string "       Prove that you can't miss        "
	intros15: string "       and if you miss, i'll            "
	intros16: string "       have a little chat with you      "
	intros17: string "                                        "
	intros18: string "                                        "
	intros19: string "                                        "
	intros20: string "          ass: Darth Vader              "
	intros21: string "                                        "
	intros22: string "                                        "
	intros23: string "                                        "
	intros24: string "                                        "
	intros25: string "           [PRESS ENTER]                "
	intros26: string "                                        "
	intros27: string "                                        "
	intros28: string "                                        "
	intros29: string "                                        "
	intros30: string "                                        "

;palleta do fundo do jogo: linha manual e chão
	mensagem1: string "                                        "
	mensagem2: string "                                        "
	mensagem3: string "                                        "
	mensagem4: string "                                        "
	mensagem5: string "                                        "
	mensagem6: string "                                        "
	mensagem7: string "                                        "
	mensagem8: string "                                        "
	mensagem9: string "                                        "
	mensagem10: string "                                        "
	mensagem11: string "                                        "
	mensagem12: string "                                        "
	mensagem13: string "                                        "
	mensagem14: string "                                        "
	mensagem15: string "                                        "
	mensagem16: string "                                        "
	mensagem17: string "                                        "
	mensagem18: string "                                        "
	mensagem19: string "                                        "
	mensagem20: string "                                        "
	mensagem21: string "                                        "
	mensagem22: string "                                        "
	mensagem23: string "                                        "
	mensagem24: string "                                        "
	mensagem25: string "                                        "
	mensagem26: string "                                        "
	mensagem27: string "                                        "
	mensagem28: string "                                        "
	mensagem29: string "                                        "
	mensagem30: string "                                        "


;fundo do jogo: linha-manual e chão
	mensagemA1: string "Movement: w, a, s, d. Shoot: SPACEBAR.  "
	mensagemA2: string "                                        "
	mensagemA3: string "                                        "
	mensagemA4: string "                                        "
	mensagemA5: string "                                        "
	mensagemA6: string "                                        "
	mensagemA7: string "                                        "
	mensagemA8: string "                                        "
	mensagemA9: string "                                        "
	mensagemA10: string "                                        "
	mensagemA11: string "                                        "
	mensagemA12: string "                                        "
	mensagemA13: string "                                        "
	mensagemA14: string "                                        "
	mensagemA15: string "                                        "
	mensagemA16: string "                                        "
	mensagemA17: string "                                        "
	mensagemA18: string "                                        "
	mensagemA19: string "                                        "
	mensagemA20: string "                                        "
	mensagemA21: string "                                        "
	mensagemA22: string "                                        "
	mensagemA23: string "                                        "
	mensagemA24: string " _____                                  "
	mensagemA25: string "|  ___|                                 "
	mensagemA26: string "| |___            mmm                   "
	mensagemA27: string "|     |   mm     m   m                  "
	mensagemA28: string "|     |  m  m   m     m    m    m       "
	mensagemA29: string "|     | m    m m       m  m m  m m  mmm "
	mensagemA30: string "|     |m      m         m    mm   mm   m"

;paletta do fundo: céu e deathstar
	mensagemB1: string "                                        "
	mensagemB2: string "                                        "
	mensagemB3: string "                                        "
	mensagemB4: string "                                        "
	mensagemB5: string "                                        "
	mensagemB6: string "                                        "
	mensagemB7: string "                                        "
	mensagemB8: string "                                        "
	mensagemB9: string "                                        "
	mensagemB10: string "                                        "
	mensagemB11: string "                                        "
	mensagemB12: string "                                        "
	mensagemB13: string "                                        "
	mensagemB14: string "                                        "
	mensagemB15: string "                                        "
	mensagemB16: string "                                        "
	mensagemB17: string "                                        "
	mensagemB18: string "                                        "
	mensagemB19: string "                                        "
	mensagemB20: string "                                        "
	mensagemB21: string "                                        "
	mensagemB22: string "                                        "
	mensagemB23: string "                                        "
	mensagemB24: string "                                        "
	mensagemB25: string "                                        "
	mensagemB26: string "                                        "
	mensagemB27: string "                                        "
	mensagemB28: string "                                        "
	mensagemB29: string "                                        "
	mensagemB30: string "                                        "

;fundo do jogo: céu e deathstar
	mensagemC1: string "                                        "
	mensagemC2: string " .    __           .                .   "
	mensagemC2: string "  _.-'   ' ._  .            .    .      "
	mensagemC3: string " , (_)-    --,        *  .              "
	mensagemC4: string " | == ====                    .    .    "
	mensagemC5: string " '--  - ---    '  .                     "
	mensagemC8: string "   '-.___     '                .        "
	mensagemC9: string "         . '       .   .          .     "
	mensagemC10: string " .            .            .            "
	mensagemC11: string "      *              .          *   .   "
	mensagemC12: string " .   .      .  *          .             "
	mensagemC13: string "                    .           .       "
	mensagemC14: string "                                        "
	mensagemC15: string "                                        "
	mensagemC16: string "                                        "
	mensagemC17: string "                                        "
	mensagemC18: string "                                        "
	mensagemC19: string "                                        "
	mensagemC20: string "                                        "
	mensagemC21: string "                                        "
	mensagemC22: string "                                        "
	mensagemC23: string "                                        "
	mensagemC24: string "                                        "
	mensagemC25: string "                                        "
	mensagemC26: string "                                        "
	mensagemC27: string "                                        "
	mensagemC28: string "                                        "
	mensagemC29: string "                                        "
	mensagemC30: string "                                        "


;paleta de cores, tela de fim
	mensagemD1: string "                                        "
	mensagemD2: string "                                        "
	mensagemD3: string "                                        "
	mensagemD4: string "                                        "
	mensagemD5: string "                                        "
	mensagemD6: string "                                        "
	mensagemD7: string "                                        "
	mensagemD8: string "                                        "
	mensagemD9: string "                                        "
	mensagemD10: string "                                        "
	mensagemD11: string "                                        "
	mensagemD12: string "                                        "
	mensagemD13: string "                                        "
	mensagemD14: string "                                        "
	mensagemD15: string "                                        "
	mensagemD16: string "                                        "
	mensagemD17: string "                                        "
	mensagemD18: string "                                        "
	mensagemD19: string "                                        "
	mensagemD20: string "                                        "
	mensagemD21: string "                                        "
	mensagemD22: string "                                        "
	mensagemD23: string "                                        "
	mensagemD24: string "                                        "
	mensagemD25: string "                                        "
	mensagemD26: string "                                        "
	mensagemD27: string "                                        "
	mensagemD28: string "                                        "
	mensagemD29: string "                                        "
	mensagemD30: string "                                        "

;tela de winning
	win1: string "                                        "
	win2: string "                                        "
	win3: string "      At last, you didn't miss          "
	win4: string "      Today, your actions helped        "
	win5: string "      The Empire  save the galaxy       "
	win6: string "      of the threat imposed by the      "
	win7: string "      rebel scum                        "
	win8: string "                                        "
	win9: string "                                        "
	win10: string "                                        "
	win11: string "                                        "
	win12: string "                                        "
	win13: string "                                        "
	win14: string "                                        "
	win15: string "      And you just ruined               "
	win17: string "      the best film in the whole        "
	win17: string "      trilogy. No more 'I am your       "
	win18: string "      father' moment now. You ruined    "
	win19: string "      everything. No more Jar Jar Binks "
	win20: string "      No more disney, no more           "
	win21: string "      J. J. Abrams                      "
	win22: string "                                        "
	win23: string "                                        "
	win24: string "                                        "
	win25: string "          You ruined everything         "
	win26: string "                                        "
	win27: string "                                        "
	win28: string "                                        "
	win29: string "                                        "
	win30: string "                                        "
	
;tela de losing
	lose01: string "                                        "
	lose02: string "                                        "
	lose03: string "                                        "
	lose04: string "  ___  ___  _  _    _ _  ___  ___       "
	lose05: string " |  _|| _ || || |  | | || _ \|  _|      "
	lose06: string " |  _||   || || |_ | | ||   /|  _|      "
	lose07: string " |_|  |_|_||_||___||___||_|_\|___|      "
	lose08: string "                                        "
	lose09: string "                                        "
	lose10: string "                                        "
	lose11: string "      You suck!                         "
	lose12: string "      It would appear you've            "
	lose13: string "      thrown your chances               "
	lose14: string "      to the wind.                      "
	lose15: string "                                        "
	lose16: string "      Lord Vader is very                "
	lose17: string "      displeased with you.              "
	lose18: string "                                        "
	lose19: string "      He looks like he wants            "
	lose20: string "      to have a little chat             "
	lose21: string "                                        "
	lose22: string "                                        "
	lose23: string "                                        "
	lose24: string "                                        "
	lose25: string "                                        "
	lose26: string "                                        "
	lose27: string "                                        "
	lose28: string "                                        "
	lose29: string "                                        "
	lose30: string "                                        "

;possíveis movimentos do alien
rand : var #30
	static rand + #0, #2
	static rand + #1, #1
	static rand + #2, #2
	static rand + #3, #1
	static rand + #4, #0
	static rand + #5, #2
	static rand + #6, #1
	static rand + #7, #0
	static rand + #8, #0
	static rand + #9, #1
	static rand + #10, #2
	static rand + #11, #1
	static rand + #12, #2
	static rand + #13, #1
	static rand + #14, #0
	static rand + #15, #0
	static rand + #16, #1
	static rand + #17, #1
	static rand + #18, #2
	static rand + #19, #2
	static rand + #20, #0
	static rand + #21, #0
	static rand + #22, #2
	static rand + #23, #2
	static rand + #24, #2
	static rand + #25, #1
	static rand + #26, #1
	static rand + #27, #2
	static rand + #28, #0
	static rand + #29, #2
	static rand + #30, #1
	static rand + #31, #1
	static rand + #32, #0
	static rand + #33, #2
	static rand + #34, #1
	static rand + #35, #0
	static rand + #36, #2
	static rand + #37, #1
	static rand + #38, #1
	static rand + #39, #2
	static rand + #40, #2
	static rand + #41, #1
	static rand + #42, #0
	static rand + #43, #0
	static rand + #44, #0
	static rand + #45, #1
	static rand + #46, #2
	static rand + #47, #2
	static rand + #48, #1
	static rand + #49, #0
	static rand + #50, #0
	static rand + #51, #1
	static rand + #52, #2
	static rand + #53, #1
	static rand + #54, #0
	static rand + #55, #2
	static rand + #56, #2
	static rand + #57, #0
	static rand + #58, #0
	static rand + #59, #1
	static rand + #60, #2
	static rand + #61, #1
	static rand + #62, #0
	static rand + #63, #2
	static rand + #64, #1
	static rand + #65, #2
	static rand + #66, #0
	static rand + #67, #1
	static rand + #68, #0
	static rand + #69, #1
	static rand + #70, #2
	static rand + #71, #2
	static rand + #72, #2
	static rand + #73, #0
	static rand + #74, #0
	static rand + #75, #1
	static rand + #76, #1
	static rand + #77, #0
	static rand + #78, #0
	static rand + #79, #1
	static rand + #80, #2
	static rand + #81, #2
	static rand + #82, #0
	static rand + #83, #1
	static rand + #84, #1
	static rand + #85, #0
	static rand + #86, #0
	static rand + #87, #1
	static rand + #88, #2
	static rand + #89, #0
	static rand + #90, #1
	static rand + #91, #2
	static rand + #92, #2
	static rand + #93, #0
	static rand + #94, #1
	static rand + #95, #1
	static rand + #96, #2
	static rand + #97, #0
	static rand + #98, #1
	static rand + #99, #0

;Nave:
;posição atual e anterior
PosNave: var #1
PosNaveAnterior: var #1
;Alien:
;posição atual e anterior
PosAlien: var #1
PosAlienAnterior: var #1
;Tiro:
;posição atual, anterior e a Flag de Tiro
PosTiro: var #1
PosTiroAnterior: var #1
FlagTiro: var #1
;Movimento que o Alien fará
MovimentoAlien: var #1

PosRand: var #1

;OBS: A função desenhaTelaAmarelo foi adaptada para que não atrapalhasse a 
;palleta de cores - por algum motivo, a função arrumaCores causava problemas
;na impressão das telas de intro.
;não conseguimos implementar a colisão entre Nave e Alien. Passamos por algumas
;dificuldades até a data da entrega.


;*********main*********
;@description: função principal. Responsável pelo preset do jogo -
;			   checar loop em mainLoop
;@args:
;r0: usado inicialmente para posicionar a nave. Usando 0 como valor inicial
;r1: Telas a serem impressas
;r7: valor ASCII do ENTER

main:
;  primeira tela de intro
	loadn r1, #intro1

; esperamos o ENTER
    call desenhaTelaAmarelo
	call EsperaOcupada

; segunda tela de intro
    loadn r1, #intros1
    call desenhaTelaAmarelo
	call EsperaOcupada
	
; inicialização do jogo
	call arrumaCores
	call arrumaTela
    loadn r1, #mensagem1
    call desenhaTela
	loadn r0, #0
	store PosNave, r0
	store PosNaveAnterior, r0
	store FlagTiro, r0
	loadn r1, #'{'              ;caractere da nave do p1
	outchar r1, r0
	loadn r0, #1199
	store PosAlien, r0
	store PosAlienAnterior, r0
	loadn r1, #'~'             ; caratere do inimigo
	outchar r1, r0
	loadn r0, #'~'
	store MovimentoAlien, r0
	loadn r0, #10
	store PosRand, r0
	push r0
	push r1
	push r2
	push r3
	push r4
	push r5
	push r6
	push r7
	loadn r0, #1
	loadn r1, #4
	loadn r2, #2
	loadn r3, #4
	loadn r4, #0

;*********mainLoop*********
;@description: Loop principal do jogo com as seguintes ações:
;              a) chamar o delay para reduzir a velocidade de movimentação
;              b) desenhar a Nave
;              c) desenhar o Alien
;              d) desenha o tiro (se o usuário tiver atirado =] )
;@args:
;r0: usado inicialmente para posicionar a nave. Usando 0 como valor inicial
;r1: Telas a serem impressas
;r4: flag para comparar se devemos desenhar a nave e/ou tiro e/ou alien
    mainLoop:
		cmp r0, r1
		jne mainLoopSkip
		loadn r0, #1
	mainLoopSkip:
		call delay
		mod r5, r3, r0
		cmp r5, r4
		ceq desenhaNave
		mod r5, r2, r0
		cmp r5, r4
		ceq desenhaAlien
		call desenhaTiro
		call testaFimTiro
		call testaFimColisao
		inc r0
		jmp mainLoop
	mainSai:
		loadn r1, #win1
		call desenhaTelaAmarelo
		pop r7
		pop r6
		pop r5
		pop r4
		pop r3
		pop r2
		pop r1
		pop r0
		halt
	mainSaiLoss:
		loadn r1, #lose01
		call desenhaTelaAmarelo
		pop r7
		pop r6
		pop r5
		pop r4
		pop r3
		pop r2
		pop r1
		pop r0
		halt
				
testaFimTiro:
	load r6, PosAlien
	load r7, PosTiro
	cmp r6, r7
	jeq mainSai
	rts
	
testaFimColisao:
	load r6, PosAlien
	load r7, PosNave
	cmp r6, r7
	jeq mainSaiLoss
	rts
 

;*********arrumaTela*********
;@description: arruma conflitos de cor na paleta
;			   
;@args:
;r0: usado inicialmente para posicionar a nave. Usando 0 como valor inicial
;r1: Telas a serem impressas
;r7: valor ASCII do ENTER
;@NEEDS HELP

arrumaTela: ;seta os valores das cores respectivas para cada trecho da tela.
	push r0
	push r1
	push r2
	loadn r0, #1024 
	loadn r1, #mensagemA1
	loadn r2, #mensagem1
	call arrumaCores
	loadn r0, #3584
	loadn r1, #mensagemB1
	loadn r2, #mensagem1
	call arrumaCores
	loadn r0, #2048
	loadn r1, #mensagemC1
	loadn r2, #mensagem1
	call arrumaCores
	loadn r0, #3072
	loadn r1, #mensagemD1
	loadn r2, #mensagem1
	call arrumaCores
	pop r2
	pop r1
	pop r0
	rts

;*********arrumaCores*********
;@description: evitar o conflito entre a paleta de cores 
;			   
;
;@args:
;r0: usado inicialmente para posicionar a nave. Usando 0 como valor inicial
;r1: Telas a serem impressas
;r7: valor ASCII do ENTER
;
;@NEEDS HELP
arrumaCores: 
	push r3
	push r4
	push r5
	push r6
	loadn r3, #' '
	loadn r5, #1230 ;tamanho total da tela incluindo '\0'
	loadn r6, #'\0'
	arrumaCoresLoop:
		loadi r4, r1
		cmp r4, r3
		jeq arrumaCoresLoopSkip
		cmp r4, r6
		jeq arrumaCoresLoopSkip
		add r4, r0, r4
		storei r2, r4
	arrumaCoresLoopSkip:
		dec r5
		jz arrumaCoresSai
		inc r1
		inc r2
		jmp arrumaCoresLoop
	arrumaCoresSai:
		pop r6
		pop r5
		pop r4
		pop r3
		rts

;*********desenhaTela*********
;@description: fará o print da tela atual
;@args:
;r1: primeira string
;r5: nLinhas
;r6: nColunas
	
desenhaTela: ;função para desenhar as telas.
	push r0
	push r1
	push r2
	push r5
	push r6
	loadn r0, #0
	loadn r2, #0
	loadn r5, #30
	loadn r6, #40
	desenhaTelaLoop:
		call imprimeString
		add r0, r6, r0 ;posição seguinte
		add r1, r6, r1 ;string seguinte
		inc r1
		dec r5
		jnz desenhaTelaLoop
	pop r6
	pop r5
	pop r2
	pop r1
	pop r0
	rts

;*********imprimeString*********
;@description: imprime a string em R1
;@args
;	r1: string
;	r2: cor da mensagem
;	r4: char a ser impresso
;	r5: nLinhas
;	r6: nColunas
	
imprimeString:
	push r0
	push r1
	push r2
	push r3
	push r4
	loadn r3, #'\0'
	imprimeStringLoop:
		loadi r4, r1
		cmp r4, r3
		jeq imprimeStringSai
		add r4, r2, r4
		outchar r4, r0
		inc r0
		inc r1
		jmp imprimeStringLoop
	imprimeStringSai:
		pop r4
		pop r3
		pop r2
		pop r1
		pop r0
		rts
		
		
;*********apagaTiro*********
;@description: Apaga o tiro na posição anterior
;@args
;	r1: mensagem
;	r2: cor da mensagem
;	r4: char a ser impresso
;	r5: nLinhas
;	r6: nColunas

apagaTiro:
	push r0
	push r1
	push r2
	push r3
	push r4
	push r5
	load r0, PosTiroAnterior
	loadn r1, #mensagem1
	add r2, r1, r0
	loadn r4, #40
	div r3, r0, r4
	add r2, r2, r3
	loadi r5, r2
	outchar r5, r0
	pop r5
	pop r4
	pop r3
	pop r2
	pop r1
	pop r0
	rts

;*********desenhaTiro*********
;@description: desenha o Tiro da Nave na posição atual.
;@args
;	r0: flag de Tiro
;	r1: 
;	r2: cor da mensagem
;	r4: char a ser impresso
;	r5: nLinhas
;	r6: nColunas

desenhaTiro: ;desenha o tiro na linha onde se está na tela
	push r0
	push r1
	load r0, FlagTiro
	loadn r1, #1
	cmp r0, r1 ;se o player atirou
	jeq desenhaTiroSkip
	loadn r1, #1201
	store PosTiro, r1
	inchar r0
	loadn r1, #' '
	cmp r0, r1
	jne desenhaTiroSai
	loadn r1, #1
	store FlagTiro, r1
	load r0, PosNave
	inc r0
	store PosTiro, r0
	store PosTiroAnterior, r0

;*********desenhaTiroSkip*********
;@description: Chamada se o player atirou. Desenha o tiro na posição atual
;@args
;	posTiro: posição do tiro
;	PosTiroAnterior: posição anterior do tiro 
;	r2: cor da mensagem
;	r4: char a ser impresso
;	r5: nLinhas
;	r6: nColunas

desenhaTiroSkip:
	load r0, PosTiro
	store PosTiroAnterior, r0
	call moveTiro
	load r0, PosTiro
	loadn r1, #'-'
	outchar r1, r0
	call apagaTiro
	desenhaTiroSai:
		pop r1
		pop r0
		rts
		
;*********moveTiro*********
;@description: move o tiro na tela
;@args
;	posTiro: posição atual do tiro
;	
;	
;	
;	
moveTiro: ;move o tiro encima da posição da tela
	push r2
	push r4
	push r5
	push r6
	load r4, PosTiro
	loadn r5, #40
	mod r5, r4, r5
	loadn r6, #39
	cmp r5, r6
	jne moveTiroSkip
	loadn r2, #0
	store FlagTiro, r2
	dec r4
moveTiroSkip:
	inc r4
	store PosTiro, r4
	pop r6
	pop r5
	pop r4
	pop r2

;*********apagaAlien*********
;@description: Apaga o alien na posição antes dele se movimentar
;@args
;   PosAlienAnterior: posição anterior ao movimento do alien	
;	
;	
;	
;	

apagaAlien:
	push r0
	push r1
	push r2
	push r3
	push r4
	push r5
	load r0, PosAlienAnterior
	loadn r1, #mensagem1
	add r2, r1, r0
	loadn r4, #40
	div r3, r0, r4
	add r2, r2, r3
	loadi r5, r2
	outchar r5, r0
	pop r5
	pop r4
	pop r3
	pop r2
	pop r1
	pop r0
	rts
	
;*********desenhaAlien*********
;@description: Apaga o tiro na posição anterior
;@args
;   	
;	
;	
;	
;	

desenhaAlien:;desenha o alien na próxima posição aleatória
	push r0
	push r1
	load r0, PosAlien
	store PosAlienAnterior, r0
	call moveAlien
	load r0, PosAlien
	load r1, PosAlienAnterior
	cmp r0, r1
	jeq desenhaAlienSai
	loadn r1, #'~'              ;883
	outchar r1, r0
	call apagaAlien
	desenhaAlienSai:
		pop r1
		pop r0
		rts

;*********moveAlien*********
;@description: escolhe um movimento aleatório dentre 3 possíveis
;              de acordo com a tecla que o usuário clica
;              (por isso os métodos *1, *2, *3)
;@args
;	posAlien: Posição atual do alien
;	PosRand: Posição aleatória para o próximo movimento do Alien (vetor)
;	MovimentoAlien: último movimento que o alien executou.
;	
;	
;@NEEDS HELP
moveAlien:;função responsável pelo movimento do alien
	push r2
	push r3
	push r4
	push r5
	push r6
	load r4, PosAlien
	load r2, PosRand
	loadn r3, #100
	cmp r2, r3
	jne moveAlienSkip
	loadn r2, #0
	moveAlienSkip:
		loadn r3, #rand
		add r3, r2, r3
		inc r2
		store PosRand, r2
		loadi r2, r3
		add r2, r4, r2
		loadn r3, #3
		mod r2, r2, r3
		load r3, MovimentoAlien
		loadn r5, #'w'
		cmp r3, r5
		jeq moveAlienW
		loadn r5, #'a'
		cmp r3, r5
		jeq moveAlienA
		loadn r5, #'s'
		cmp r3, r5
		jeq moveAlienS
		loadn r5, #'d'
		cmp r3, r5
		jeq moveAlienD
	moveAlienW:
		loadn r3, #0
		cmp r2, r3
		jeq moveAlienW0
		loadn r3, #1
		cmp r2, r3
		jeq moveAlienW1
		loadn r3, #2
		cmp r2, r3
		jeq moveAlienW2
		moveAlienW0:
			loadn r2, #'a'
			store MovimentoAlien, r2
			loadn r5, #40
			mod r5, r4, r5
			loadn r6, #0
			cmp r5, r6
			jeq moveAlienSai
			dec r4
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienW1:
			loadn r5, #40
			cmp r4, r5
			jle moveAlienSai
			sub r4, r4, r5
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienW2:
			loadn r2, #'d'
			store MovimentoAlien, r2
			loadn r5, #40
			mod r5, r4, r5
			loadn r6, #39
			cmp r5, r6
			jeq moveAlienSai
			inc r4
			store PosAlien, r4
			jmp moveAlienSai
	moveAlienA:
		loadn r3, #0
		cmp r2, r3
		jeq moveAlienA0
		loadn r3, #1
		cmp r2, r3
		jeq moveAlienA1
		loadn r3, #2
		cmp r2, r3
		jeq moveAlienA2
		moveAlienA0:
			loadn r2, #'s'
			store MovimentoAlien, r2
			loadn r5, #1159
			cmp r4, r5
			jgr moveAlienSai
			loadn r6, #40
			add r4, r6, r4
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienA1:
			loadn r5, #40
			mod r5, r4, r5
			loadn r6, #0
			cmp r5, r6
			jeq moveAlienSai
			dec r4
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienA2:
			loadn r2, #'w'
			store MovimentoAlien, r2
			loadn r5, #40
			cmp r4, r5
			jle moveAlienSai
			sub r4, r4, r5
			store PosAlien, r4
			jmp moveAlienSai
	moveAlienS:
		loadn r3, #0
		cmp r2, r3
		jeq moveAlienS0
		loadn r3, #1
		cmp r2, r3
		jeq moveAlienS1
		loadn r3, #2
		cmp r2, r3
		jeq moveAlienS2
		moveAlienS0:
			loadn r2, #'a'
			store MovimentoAlien, r2
			loadn r5, #40
			mod r5, r4, r5
			loadn r6, #0
			cmp r5, r6
			jeq moveAlienSai
			dec r4
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienS1:
			loadn r5, #1159
			cmp r4, r5
			jgr moveAlienSai
			loadn r6, #40
			add r4, r6, r4
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienS2:
			loadn r2, #'d'
			store MovimentoAlien, r2
			loadn r5, #40
			mod r5, r4, r5
			loadn r6, #39
			cmp r5, r6
			jeq moveAlienSai
			inc r4
			store PosAlien, r4
			jmp moveAlienSai
	moveAlienD:
		loadn r3, #0
		cmp r2, r3
		jeq moveAlienD0
		loadn r3, #1
		cmp r2, r3
		jeq moveAlienD1
		loadn r3, #2
		cmp r2, r3
		jeq moveAlienD2
		moveAlienD0:
			loadn r2, #'w'
			store MovimentoAlien, r2
			loadn r5, #40
			cmp r4, r5
			jle moveAlienSai
			sub r4, r4, r5
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienD1:
			loadn r5, #40
			mod r5, r4, r5
			loadn r6, #39
			cmp r5, r6
			jeq moveAlienSai
			inc r4
			store PosAlien, r4
			jmp moveAlienSai
		moveAlienD2:
			loadn r2, #'s'
			store MovimentoAlien, r2
			loadn r5, #1159
			cmp r4, r5
			jgr moveAlienSai
			loadn r6, #40
			add r4, r6, r4
			store PosAlien, r4
			jmp moveAlienSai
	moveAlienSai:
		pop r6
		pop r5
		pop r4
		pop r3
		pop r2
		rts
		
;*********apagaNave*********
;@description: Apaga a nave na posição anterior
;@args
;   PosNaveAnterior: posição anterior ao movimento da nave    	
;	
;	
;	
;	
apagaNave:
	push r0
	push r1
	push r2
	push r3
	push r4
	push r5
	load r0, PosNaveAnterior
	loadn r1, #mensagem1
	add r2, r1, r0
	loadn r4, #40
	div r3, r0, r4
	add r2, r2, r3
	loadi r5, r2
	outchar r5, r0
	pop r5
	pop r4
	pop r3
	pop r2
	pop r1
	pop r0
	rts

;*********desenhaNave*********
;@description: Apaga o tiro na posição anterior
;@args
;	r1: mensagem
;	r2: cor da mensagem
;	r4: char a ser impresso
;	r5: nLinhas
;	r6: nColunas
desenhaNave:;função responsável por desenhar a nave na posição correspondente
	push r0
	push r1
	load r0, PosNave
	store PosNaveAnterior, r0
	call moveNave
	load r0, PosNave
	load r1, PosNaveAnterior
	cmp r0, r1
	jeq desenhaNaveSai
	loadn r1, #'{'  ;#1368
	outchar r1, r0
	call apagaNave
	desenhaNaveSai:
		pop r1
		pop r0
		rts
		
;*********moveNave*********
;@description: Movimenta a nave de acordo com o comando do usuário
;@args
;	PosNave: posição atual  da nave
;	r3: caractere inserido pelo usuário
;	
;	
;	
moveNave:;movimenta a nave segundo o que foi enviado para o usuário
	push r2
	push r3
	push r4
	push r5
	push r6
	load r4, PosNave
	inchar r3
	loadn r2, #'w'
	cmp r2, r3
	jeq moveNaveW
	loadn r2, #'a'
	cmp r2, r3
	jeq moveNaveA
	loadn r2, #'s'
	cmp r2, r3
	jeq moveNaveS
	loadn r2, #'d'
	cmp r2, r3
	jeq moveNaveD
	jmp moveNaveSai
	moveNaveW:
		loadn r5, #40
		cmp r4, r5
		jle moveNaveSai
		sub r4, r4, r5
		store PosNave, r4
		jmp moveNaveSai
	moveNaveA:
		loadn r5, #40
		mod r5, r4, r5
		loadn r6, #0
		cmp r5, r6
		jeq moveNaveSai
		dec r4
		store PosNave, r4
		jmp moveNaveSai
	moveNaveS:
		loadn r5, #1159
		cmp r4, r5
		jgr moveNaveSai
		loadn r6, #40
		add r4, r6, r4
		store PosNave, r4
		jmp moveNaveSai
	moveNaveD:
		loadn r5, #40
		mod r5, r4, r5
		loadn r6, #39
		cmp r5, r6
		jeq moveNaveSai
		inc r4
		store PosNave, r4
		jmp moveNaveSai
	moveNaveSai:
		pop r6
		pop r5
		pop r4
		pop r3
		pop r2
		rts


;*********delay*********
;@description: delay inserido para que exista um atraso na movimentação
;              tanto da nave quanto do alien
;@args
;	
;	
;	
;	
;	
delay:;atraso de movimentação
	push r0
	push r1
	loadn r1, #500
	delayVolta2:
	loadn r0, #1000	; b
	delayVolta:
	dec r0					; (4*a + 6)b = 1000000  == 1 seg  em um clock de 1MHz
	jnz delayVolta
	dec r1
	jnz delayVolta2
	pop r1
	pop r0
	rts
	
	
;*********EsperaOcupada*********
;@description: cria um loop para aguardar o input do usuário 
;			   (a tecla ENTER, mais especificamente)
;@args:
;r6: Leitura do Caractere
;r7: valor ASCII do ENTER
EsperaOcupada:
    inchar r6
    loadn r7, #13
    cmp r7, r6
    jne EsperaOcupada
    rts

;*********desenhaTelaAmarelo*********
;@description: desenha as telas em amarelo (que estavam em conflito no desenhaTela)
;              Possui o mesmo o funcionamento da desenhaTela
;@args
;	
;	
;	
;	
;	
desenhaTelaAmarelo: ;função para desenhar as telas.
	push r0
	push r1
	push r2
	push r5
	push r6
	loadn r0, #0
	loadn r2, #0
	loadn r5, #30
	loadn r6, #40
	desenhaTelaLoopAmarelo:
		call imprimeStringAmarelo
		add r0, r6, r0
		add r1, r6, r1
		inc r1
		dec r5
		jnz desenhaTelaLoopAmarelo
	pop r6
	pop r5
	pop r2
	pop r1
	pop r0
	rts

	
	
	
	

;*********imprimeStringAmarelo*********
;@description: mesma função que a imprimeString
imprimeStringAmarelo:
    push r0
	push r1
	push r2
	push r3
	push r4
	loadn r2, #2816
	loadn r3, #'\0'
	imprimeStringLoopAmarelo:
		loadi r4, r1
		cmp r4, r3
		jeq imprimeStringAmareloSai
		add r4, r2, r4
		outchar r4, r0
		inc r0
		inc r1
		jmp imprimeStringLoopAmarelo
	imprimeStringAmareloSai:
		pop r4
		pop r3
		pop r2
		pop r1
		pop r0
	rts
